let formulario;document.addEventListener("DOMContentLoaded",function(){formulario=document.querySelector("#formularioContacto");formulario.addEventListener("submit",e=>{e.preventDefault();enviarFormulario(e)})});async function enviarFormulario(e){mostrarLoader();const elementos=e.target.elements;const datos_post=new FormData();for(let elemento of elementos){if(!elemento.name)continue;if(elemento.type==="radio"||elemento.type==="checkbox"){if(elemento.checked){datos_post.append(elemento.name,elemento.value)}}else{datos_post.append(elemento.name,elemento.value)}}
try{const url=e.target.getAttribute("action");const metodo=e.target.getAttribute("method")||'POST';const response=await fetch(url,{headers:{'token':mikey},method:'POST',body:datos_post});const datosRecibidos=await response.json();if(datosRecibidos.ok){mensaje('todo ok: '+datosRecibidos.mensaje,'/contacto')}else{alerta(datosRecibidos.error)}}catch(error){console.log(error)}finally{ocultarLoader()}}